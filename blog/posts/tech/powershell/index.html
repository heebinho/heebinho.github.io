<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Powershell</title>
    <link rel="icon" href="/assets/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="stylesheet" type="text/css" href="/assets/main.css"/>
    <link rel="alternate" type="application/rss+xml" href="/feed.xml" title="Feed">
    <link rel="stylesheet" type="text/css" href="/assets/fontawesome/css/fontawesome.min.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/fontawesome/css/brands.min.css"/>
    <link rel="stylesheet" type="text/css" href="/assets/fontawesome/css/solid.min.css"/>
    
    <link rel="stylesheet" type="text/css" href="/assets/highlight/styles/ascetic.css"/>
    <script src="/assets/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
  </head>
  <body>
    
          <header class="header">
        <div class="header__content">
          <h1 class="site-title-lowercase">
            <a href=/>
              renatoheeb.com
            </a>
          </h1>

          
            <nav class="nav">
              <ul class="nav__list">
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/blog/posts/travel/"  >Travel Blog</a>
                  </li>
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/blog/posts/tech/"  >Tech Blog</a>
                  </li>
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/about/"  >About</a>
                  </li>
                
              </ul>
            </nav>

          

        </div>
      </header>
      <main class="main">
        
<time class="font-bold ">15 Apr 2023</time>
<article class="prose lg:prose-xl my-10">
    <h1>Powershell</h1>
    <aside class="prose lg:prose-xl my-5"><nav class="toc" >
        <ol><li><a href="#install-%26-upgrade">Install &amp; Upgrade</a></li><li><a href="#execute">Execute</a></li><li><a href="#chrome-copy-as-ps">Chrome copy as ps</a><ol><li><a href="#save-response">Save response</a></li></ol></li></ol>
      </nav></aside>
    <p>Terminals are a fast and elegant way to manage your system.
But who can remember all the commands and switches?
These are notes to my future self.</p>
<h2 id="install-%26-upgrade" tabindex="-1">Install &amp; Upgrade</h2>
<pre><code>winget install --id Microsoft.Powershell --source winget
</code></pre>
<p><a href="https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows">doc</a></p>
<h2 id="execute" tabindex="-1">Execute</h2>
<pre><code>string script = File.ReadAllText(fi.FullName);
using var ps = PowerShell.Create();
ps.AddScript(script).Invoke();
</code></pre>
<h2 id="chrome-copy-as-ps" tabindex="-1">Chrome copy as ps</h2>
<pre><code>$session = New-Object Microsoft.PowerShell.Commands.WebRequestSession
$session.UserAgent = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&quot;
$session.Cookies.Add((New-Object System.Net.Cookie(&quot;Name&quot;, &quot;2023-04-16-08&quot;, &quot;/&quot;, &quot;.google.ch&quot;)))
Invoke-WebRequest -UseBasicParsing -Uri &quot;https://www.google.ch/&quot; `
-WebSession $session `
-Headers @{
&quot;authority&quot;=&quot;www.google.ch&quot;
  &quot;method&quot;=&quot;GET&quot;
  &quot;path&quot;=&quot;/&quot;
  &quot;scheme&quot;=&quot;https&quot;
  &quot;accept&quot;=&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;
  &quot;accept-encoding&quot;=&quot;gzip, deflate, br&quot;
  &quot;accept-language&quot;=&quot;en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7&quot;
  &quot;cache-control&quot;=&quot;no-cache&quot;
  ...
}
</code></pre>
<h3 id="save-response" tabindex="-1">Save response</h3>
<pre><code>$response = Invoke-WebRequest ...
$stream = [System.IO.StreamWriter]::new('.\response.json', $false, [System.Text.Encoding]::UTF8)
try {
    $stream.Write($response.Content)
} finally {
    $stream.Dispose()
}
</code></pre>

</article>

      </main>
          <footer class="footer">
        <div class="footer__content">

          <ul class="hero__social-links">
            
              
                
                

                
                  
                
                

                <li>
                  <a href="https://mstdn.social/@heebelcraft" target="_blank" rel="noopener noreferrer"  >Mastodon</a>
                </li>
              
                
                

                
                  
                
                

                <li>
                  <a href="https://github.com/heebinho" target="_blank" rel="noopener noreferrer"  >GitHub</a>
                </li>
              
                
                

                
                  
                
                
                  
                

                <li>
                  <a href="https://www.goodreads.com/heebinho" target="_blank" rel="noopener noreferrer" style="text-decoration: line-through"  >goodreads</a>
                </li>
              
                
                

                
                  
                
                

                <li>
                  <a href="https://bookwyrm.social/user/heebinho" target="_blank" rel="noopener noreferrer"  >bookwyrm</a>
                </li>
              
                
                

                
                  
                
                

                <li>
                  <a href="https://www.strava.com/athletes/heebinho" target="_blank" rel="noopener noreferrer"  >strava</a>
                </li>
              
            

            

              
                

                
                  
                

                <li>
                  <a href="/feed.xml" target="_blank" rel="noopener noreferrer" >RSS</a>
                </li>
              
            
          </ul>

          
          <p class="footer__attribution">Copyright Â© 1984-2024 Renato Heeb. All rights reserved.</a></p>
          
          


        </div>

      </footer>







    

    <script src="/assets/main.js"></script>
  </body>
</html>