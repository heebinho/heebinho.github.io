<!doctype html>
<html lang="en">
  <head>
    <title>Blazor hosted on github-pages</title>
    <link rel="stylesheet" type="text/css" href="/assets/main.css"/>
    
    
    <link rel="stylesheet" type="text/css" href="/styles/tokyo-night-dark.css"/>
    <link rel="alternate" type="application/rss+xml" href="/feed.xml" title="Feed">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
  </head>
  <body class="">
    <nav class="grid grid-cols-2 px-5 py-5 border-b rounded-b-3xl bg-neutral text-neutral-content">
  <div class="">
    <a href="/" class="font-semibold text-xl tracking-tight">#</a>
  </div>
  <div class="">

    
    <ul class="text-right">
      
        <li class="inline">
          <a
          href="/blog/posts/travel/"
          class="uppercase text-sm py-1 px-2 rounded mr-4 inline-block
          text-white hover:text-gray-900">
          Travel Blog
        </a>
        </li>
      
        <li class="inline">
          <a
          href="/blog/posts/tech/"
          class="uppercase text-sm py-1 px-2 rounded mr-4 inline-block
          bg-yellow-100 text-black">
          Tech Blog
        </a>
        </li>
      
        <li class="inline">
          <a
          href="/contact/"
          class="uppercase text-sm py-1 px-2 rounded mr-4 inline-block
          text-white hover:text-gray-900">
          About
        </a>
        </li>
      
  </ul>

  </div>
</nav>



    <main class="p-12">
      <h1 class="text-3xl font-bold mb-8 ">Blazor hosted on github-pages</h1>
      
<time class="font-bold ">21 Apr 2020</time>
<aside class="prose lg:prose-xl my-5"><nav class="toc" >
        <ol><li><a href="#intro">Intro</a></li><li><a href="#blazor-webassembly">Blazor webassembly</a></li><li><a href="#github-pages">GitHub Pages</a></li><li><a href="#bypassing-jekyll">Bypassing Jekyll</a></li><li><a href="#hosting-on-subdirecotry-and-spa-routing">Hosting on Subdirecotry and SPA Routing</a></li><li><a href="#failing-integrity-checks">Failing integrity checks</a></li></ol>
      </nav></aside>
<article class="prose lg:prose-xl my-10"><h3 id="intro" tabindex="-1">Intro</h3>
<p>While deploying my first &quot;Blazor webassembly&quot; app to &quot;GitHub pages&quot; I ran into some minor troubles.
The following notes may be helpful for someone else.</p>
<h3 id="blazor-webassembly" tabindex="-1">Blazor webassembly</h3>
<p>Blazor is a web framework using C#, Razor and HTML that runs in the browser with WebAssembly.
You can find more information on <a href="https://blazor.net/">https://blazor.net</a></p>
<h3 id="github-pages" tabindex="-1">GitHub Pages</h3>
<p>GitHub Pages allows you to publish your website for free, hosted directly from your GitHub repository. Just edit, push, and your changes are live.
You can find more information on <a href="https://pages.github.com/">https://pages.github.com</a></p>
<h3 id="bypassing-jekyll" tabindex="-1">Bypassing Jekyll</h3>
<p>GitHub Pages is using the static site generator <a href="https://jekyllrb.com/">Jekyll</a> to publish your site.
When publishing your Blazor app you'll end up with a folder named _framework.
The problem is that Jekyll won't process that _framework folder because it starts with an underscore:</p>
<blockquote>
<p>Every file or directory beginning with the following characters: ., _ , # or ~ in the source directory will not be included in the destination folder</p>
</blockquote>
<p>To circumvent that problem you can add a file with the name .nojekyll to the root directory of your repo. (<a href="https://github.blog/2009-12-29-bypassing-jekyll-on-github-pages/">Bypass Jekyll</a>)</p>
<h3 id="hosting-on-subdirecotry-and-spa-routing" tabindex="-1">Hosting on Subdirecotry and SPA Routing</h3>
<p>I already use a static site generator and publish to the root directory of the master branch. So my Blazor experiment has to go into a subdirectory. To get your app up and running you'll have to set the base as follows:</p>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">base</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/subdirectory/&quot;</span> /&gt;</span>
</code></pre>
<p>If you're lucky you can reach your Blazor app now. But you can't reach for example domain.com/subdirectory/counter because GitHub Pages doesn't natively support single page apps. You can use a straightforward solution from <a href="https://github.com/rafrex/spa-github-pages#readme">rafrex</a> to overcome this routing issue. Just add a custom <a href="https://github.com/rafrex/spa-github-pages/blob/gh-pages/404.html">404.html</a> to the root directory of your master branch.
Dont't forget to adjust the segment count in the script:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> segmentCount = <span class="hljs-number">1</span>;

<span class="hljs-keyword">var</span> l = <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>;
l.<span class="hljs-title function_">replace</span>(
  l.<span class="hljs-property">protocol</span> + <span class="hljs-string">&#x27;//&#x27;</span> + l.<span class="hljs-property">hostname</span> + (l.<span class="hljs-property">port</span> ? <span class="hljs-string">&#x27;:&#x27;</span> + l.<span class="hljs-property">port</span> : <span class="hljs-string">&#x27;&#x27;</span>) +
  l.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span> + segmentCount).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-string">&#x27;/?p=/&#x27;</span> +
  l.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">slice</span>(segmentCount).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">&#x27;~and~&#x27;</span>) +
  (l.<span class="hljs-property">search</span> ? <span class="hljs-string">&#x27;&amp;q=&#x27;</span> + l.<span class="hljs-property">search</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">&#x27;~and~&#x27;</span>) : <span class="hljs-string">&#x27;&#x27;</span>) +
  l.<span class="hljs-property">hash</span>
);
</code></pre>
<p>One last thing to do - add the following script to your index.html:</p>
<pre><code class="language-javascript">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;
  <span class="hljs-comment">// Single Page Apps for GitHub Pages</span>
  <span class="hljs-comment">// https://github.com/rafrex/spa-github-pages</span>
  <span class="hljs-comment">// Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License</span>
  <span class="hljs-comment">// ----------------------------------------------------------------------</span>
  (<span class="hljs-keyword">function</span>(<span class="hljs-params">l</span>) {
    <span class="hljs-keyword">if</span> (l.<span class="hljs-property">search</span>) {
      <span class="hljs-keyword">var</span> q = {};
      l.<span class="hljs-property">search</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&amp;&#x27;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) {
        <span class="hljs-keyword">var</span> a = v.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;=&#x27;</span>);
        q[a[<span class="hljs-number">0</span>]] = a.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;=&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/~and~/g</span>, <span class="hljs-string">&#x27;&amp;&#x27;</span>);
      });
      <span class="hljs-keyword">if</span> (q.<span class="hljs-property">p</span> !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">replaceState</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>,
          l.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>) + (q.<span class="hljs-property">p</span> || <span class="hljs-string">&#x27;&#x27;</span>) +
          (q.<span class="hljs-property">q</span> ? (<span class="hljs-string">&#x27;?&#x27;</span> + q.<span class="hljs-property">q</span>) : <span class="hljs-string">&#x27;&#x27;</span>) +
          l.<span class="hljs-property">hash</span>
        );
      }
    }
  }(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>))
&lt;/script&gt;
</code></pre>
<h3 id="failing-integrity-checks" tabindex="-1">Failing integrity checks</h3>
<p>I use Azure DevOps pipelines to publish my <a href="https://wyam.io">Wyam</a> site. When I integrated my Blazor app I ended up with failing integrity checks when trying to access it. Probably because I've used a Windows image where the git config option core.autocrlf option was set to true. You can find possible solutions and background informations here: <a href="https://github.com/dotnet/aspnetcore/issues/19796">https://github.com/dotnet/aspnetcore/issues/19796</a></p>
</article>

    </main>
  
</article>
    <footer class="footer items-center p-4 bg-neutral text-neutral-content">
  <div class="items-center grid-flow-col">
    <svg width="36px" height="36px" viewBox="-3 0 150 150" xmlns="http://www.w3.org/2000/svg">
      <path d="M132 59.35V131.25H120V100L114 87.5V103.125C114 103.638 113.94 104.15 113.82 104.65L107.382 131.25H95.004L101.664 103.744L91.698 81.25H78V131.25H66V81.25H59.208L54.63 90.7812L65.478 116.206L54.516 121.288L41.364 90.4625L52.326 67.6313C40.326 64.3438 32.19 53.3 30.438 37.65L12 31.25V18.75H48V31.25C48 36.8875 49.17 50 60 50L75.186 29.05L75.252 29.0375C78.966 22.875 85.5 18.75 93 18.75C98.214 18.75 102.924 20.8 106.59 24.075L128.484 49.4C130.65 52.1125 132 55.55 132 59.35Z" fill="#8D6E63"/>
      <path opacity="0.3" d="M54.63 90.7812L65.478 116.206L54.516 121.288L41.364 90.4625L45.792 81.25H59.208L54.63 90.7812ZM111 81.25H91.698L101.664 103.744L95.004 131.25H107.382L113.82 104.65C113.94 104.15 114 103.638 114 103.125V87.5L111 81.25Z" fill="#000000"/>
    </svg> 
    <p>Copyright Â© 1984-2023 All rights reserved</p>
  </div>

  <div class="grid-flow-col gap-4 md:place-self-center md:justify-self-end">
    <a target="_blank" href="https://github.com/heebinho">
      <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" class="fill-current"><path d="M12,2.2467A10.00042,10.00042,0,0,0,8.83752,21.73419c.5.08752.6875-.21247.6875-.475,0-.23749-.01251-1.025-.01251-1.86249C7,19.85919,6.35,18.78423,6.15,18.22173A3.636,3.636,0,0,0,5.125,16.8092c-.35-.1875-.85-.65-.01251-.66248A2.00117,2.00117,0,0,1,6.65,17.17169a2.13742,2.13742,0,0,0,2.91248.825A2.10376,2.10376,0,0,1,10.2,16.65923c-2.225-.25-4.55-1.11254-4.55-4.9375a3.89187,3.89187,0,0,1,1.025-2.6875,3.59373,3.59373,0,0,1,.1-2.65s.83747-.26251,2.75,1.025a9.42747,9.42747,0,0,1,5,0c1.91248-1.3,2.75-1.025,2.75-1.025a3.59323,3.59323,0,0,1,.1,2.65,3.869,3.869,0,0,1,1.025,2.6875c0,3.83747-2.33752,4.6875-4.5625,4.9375a2.36814,2.36814,0,0,1,.675,1.85c0,1.33752-.01251,2.41248-.01251,2.75,0,.26251.1875.575.6875.475A10.0053,10.0053,0,0,0,12,2.2467Z"/></svg>
    </a>

  </div>
</footer>
    <script src="/assets/main.js"></script>
  </body>
</html>